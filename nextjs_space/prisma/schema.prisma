generator client {
    provider = "prisma-client-js"
    binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x"]
    output = "/home/ubuntu/lead_gen_webapp/nextjs_space/node_modules/.prisma/client"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model GenerationJob {
  id          String   @id @default(cuid())
  cities      String[]
  businessTypes String[]
  maxLeads    Int
  status      String   @default("pending") // pending, processing, completed, failed
  progress    String   @default("Initializing...") 
  totalFound  Int      @default(0)
  totalProcessed Int   @default(0)
  error       String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  leads       Lead[]

  @@index([status])
  @@index([createdAt])
}

model Lead {
  id                    String   @id @default(cuid())
  jobId                 String
  businessName          String
  category              String
  address               String?
  city                  String?
  state                 String?
  phone                 String?
  website               String?
  emails                String[] @default([])
  possibleOwnerNames    String[] @default([])
  source                String
  outreachEmailDraft    String   @db.Text
  
  // Social Media & Enrichment
  facebookUrl           String?
  linkedinUrl           String?
  instagramUrl          String?
  twitterUrl            String?
  rating                Float?
  reviewCount           Int?
  employeeCount         String?
  
  // Lead Management
  tags                  String[] @default([])
  notes                 String?  @db.Text
  isContacted           Boolean  @default(false)
  contactedAt           DateTime?
  
  createdAt             DateTime @default(now())
  updatedAt             DateTime @default(now()) @updatedAt
  
  job                   GenerationJob @relation(fields: [jobId], references: [id], onDelete: Cascade)

  @@index([jobId])
  @@index([category])
  @@index([isContacted])
}